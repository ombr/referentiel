{"version":3,"file":"referentiel.js","sourceRoot":"","sources":["../src/referentiel.ts"],"names":[],"mappings":"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C,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;aACjD;YACD;gBACE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;aACjD;YACD;gBACE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;gBAChD,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,MAAM;aACjD;SACF,CAAC;IACJ,CAAC;IAEM,oBAAQ,GAAf,UAAgB,CAAS,EAAE,CAAS;QAClC,IAAM,KAAK,GAAG,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAU,CAAC;QACjC,IAAM,GAAG,GAAW;YAClB,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YACf,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;YACf,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;SAChB,CAAC;QACF,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC;YACd,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC;gBACd,KAAK,CAAC,OAAO,CAAC,UAAC,CAAC,IAAK,OAAA,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAhC,CAAgC,CAAC,CAAC;YACzD,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QACH,OAAO,GAAG,CAAC;IACb,CAAC;IAlRD;QAAC,KAAK;;;;0CAGL;IAED;QAAC,KAAK;;;;uCAiBL;IA6PH,kBAAC;CAAA,AAlUD,IAkUC;AAED,OAAO,EAAE,WAAW,EAAE,CAAC","sourcesContent":["export type Matrix = [\n  [number, number, number],\n  [number, number, number],\n  [number, number, number]\n];\nfunction cache(\n  _target: unknown,\n  propertyKey: string,\n  descriptor?: PropertyDescriptor\n) {\n  const cacheKey = `_${propertyKey}`;\n  if (!descriptor) return;\n  const originalMethod = descriptor.value;\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\n  descriptor.value = function (this: any) {\n    // eslint-disable-next-line no-prototype-builtins\n    if (this.hasOwnProperty(cacheKey)) {\n      return this[cacheKey];\n    }\n    this[cacheKey] = originalMethod.apply(this, []);\n    return this[cacheKey];\n  };\n}\n\nclass Referentiel {\n  reference: Node;\n  static jquery?: (element: Node) => { css: (a: string) => string };\n  offsetParent: Node | null;\n  constructor(reference: Node, offsetParent: Node | null = null) {\n    this.reference = reference;\n    this.offsetParent = offsetParent;\n  }\n\n  static convertPointFromPageToNode(node: Node, point: [number, number]) {\n    const referenciel = new Referentiel(node);\n    return referenciel.convertPointFromPageToNode(point);\n  }\n\n  convertPointFromPageToNode(point: [number, number]): [number, number] {\n    return this.globalToLocal(point);\n  }\n\n  globalToLocal(point: [number, number]): [number, number] {\n    return Referentiel.multiplyPoint(this.matrixInv(), point);\n  }\n\n  localToGlobal(point: [number, number]): [number, number] {\n    return Referentiel.multiplyPoint(this.matrix(), point);\n  }\n\n  static multiplyPoint(m: Matrix, point: [number, number]): [number, number] {\n    const res = Referentiel.multiply(m, [\n      [point[0], 0, 0],\n      [point[1], 0, 0],\n      [1, 0, 0],\n    ]);\n    return [\n      Referentiel.exportNumber(res[0][0]),\n      Referentiel.exportNumber(res[1][0]),\n    ];\n  }\n\n  static exportNumber(v: number): number {\n    return parseFloat(v.toString());\n  }\n\n  _round(value: number): number {\n    const precision = 1000000.0;\n    return Math.round(precision * value) / precision;\n  }\n\n  @cache\n  matrixInv(): Matrix {\n    return Referentiel.inv(this.matrix());\n  }\n\n  @cache\n  matrix(): Matrix {\n    const matrixLocale = this.matrixLocale();\n    if (this.css(\"position\") === \"fixed\") {\n      return matrixLocale;\n    }\n    const parent = this.parent(this.reference);\n    if (parent) {\n      return Referentiel.multiply(\n        new Referentiel(\n          parent,\n          Referentiel.offsetParent(this.reference)\n        ).matrix(),\n        matrixLocale\n      );\n    }\n    return matrixLocale;\n  }\n\n  static offsetParent(node: Node): Node | null {\n    if (node instanceof HTMLElement) {\n      return node.offsetParent;\n    }\n    return null;\n  }\n\n  matrixLocale(): Matrix {\n    return Referentiel.mult(\n      this.matrixSVGViewbox(),\n      this.matrixOffset(),\n      this.matrixTransformOrigin(),\n      this.matrixTransform(),\n      Referentiel.inv(this.matrixTransformOrigin()),\n      this.matrixBorder()\n    );\n  }\n\n  matrixTransform(): Matrix {\n    if (!(this.reference instanceof HTMLElement)) {\n      return Referentiel.identity();\n    }\n    let transform = this.reference.getAttribute(\"transform\") || \"none\";\n    if (!transform.match(/^matrix\\((.*)\\)$/)) {\n      transform = this.reference.style.transform;\n    }\n    if (!transform.match(/^matrix\\((.*)\\)$/)) {\n      transform = this.css(\"transform\");\n    }\n    const res = transform.match(/^matrix\\((.*)\\)$/);\n    if (!res || !res[1]) {\n      return Referentiel.identity();\n    }\n    const floatsStr = res[1].replace(\",\", \" \").replace(\"  \", \" \").split(\" \");\n    if (floatsStr.length !== 6) throw new Error(\"Transform matrix error\");\n    const floats = floatsStr.map(function (e) {\n      return parseFloat(e);\n    }) as [number, number, number, number, number, number]; //! TODO We should do better here.\n    return [\n      [floats[0], floats[2], floats[4]],\n      [floats[1], floats[3], floats[5]],\n      [0, 0, 1],\n    ];\n  }\n\n  matrixTransformOrigin(): Matrix {\n    const transformOriginAttr = this.css(\"transform-origin\")\n      .replace(/px/g, \"\")\n      .split(\" \")\n      .map(function (v) {\n        return parseFloat(v) || 0;\n      });\n    if (transformOriginAttr.length !== 2)\n      throw new Error(\"Transform origin parsing error\"); //! TODO We should do better here.\n    const transformOrigin = transformOriginAttr as [number, number];\n    return [\n      [1, 0, transformOrigin[0]],\n      [0, 1, transformOrigin[1]],\n      [0, 0, 1],\n    ];\n  }\n\n  matrixBorder(): Matrix {\n    const left =\n      parseFloat(this.css(\"border-left-width\").replace(/px/g, \"\")) || 0;\n    const top =\n      parseFloat(this.css(\"border-top-width\").replace(/px/g, \"\")) || 0;\n    return [\n      [1, 0, left],\n      [0, 1, top],\n      [0, 0, 1],\n    ];\n  }\n\n  parent(element: Node): Node | null {\n    if (\n      element.parentNode != null &&\n      element.parentNode !== document.documentElement\n    ) {\n      return element.parentNode;\n    } else {\n      return null;\n    }\n  }\n\n  matrixOffset(): Matrix {\n    let [left, top] = this.offset(this.reference);\n    switch (this.css(\"position\")) {\n      case \"absolute\":\n        return [\n          [1, 0, left],\n          [0, 1, top],\n          [0, 0, 1],\n        ];\n      case \"fixed\":\n        left += window.pageXOffset;\n        top += window.pageYOffset;\n        return [\n          [1, 0, left],\n          [0, 1, top],\n          [0, 0, 1],\n        ];\n    }\n    if (this.offsetParent != null) {\n      if (this.offsetParent !== this.reference) {\n        [left, top] = [0, 0];\n      }\n    }\n    return [\n      [1, 0, left],\n      [0, 1, top],\n      [0, 0, 1],\n    ];\n  }\n\n  matrixSVGViewbox(): Matrix {\n    if (!(this.reference instanceof window.SVGElement)) {\n      return Referentiel.identity();\n    }\n    const size: [number, number] = [\n      parseFloat(this.css(\"width\").replace(/px/g, \"\")),\n      parseFloat(this.css(\"height\").replace(/px/g, \"\")),\n    ];\n    const attr = this.reference.getAttribute(\"viewBox\");\n    if (attr == null) {\n      return Referentiel.identity();\n    }\n    const viewBoxAttr = attr\n      .replace(\",\", \" \")\n      .replace(\"  \", \" \")\n      .split(\" \")\n      .map(function (e) {\n        return parseFloat(e);\n      });\n    if (viewBoxAttr.length !== 4) throw new Error(\"Viewbox parsing error\");\n    const viewBox = viewBoxAttr as [number, number, number, number]; //! TODO find a better way ?\n    const scale: [number, number] = [\n      size[0] / viewBox[2],\n      size[1] / viewBox[3],\n    ];\n    return Referentiel.mult(\n      [\n        [scale[0], 0, 0],\n        [0, scale[1], 0],\n        [0, 0, 1],\n      ],\n      [\n        [1, 0, -viewBox[0]],\n        [0, 1, -viewBox[1]],\n        [0, 0, 1],\n      ]\n    );\n  }\n\n  offset(element: Node): [number, number] {\n    if (!(element instanceof HTMLElement || element instanceof SVGElement)) {\n      return [0, 0];\n    }\n    if (\n      !(\n        this.reference instanceof HTMLElement ||\n        this.reference instanceof SVGElement\n      )\n    ) {\n      return [0, 0];\n    }\n    if (element instanceof HTMLElement) {\n      return [element.offsetLeft, element.offsetTop];\n    }\n    const pos = this.reference.getBoundingClientRect();\n    const offset: [number, number] = [pos.left, pos.top];\n    const parent = this.parent(element);\n    if (parent instanceof HTMLElement || parent instanceof SVGElement) {\n      const ppos = parent.getBoundingClientRect();\n      offset[0] -= ppos.left;\n      offset[1] -= ppos.top;\n    }\n    return offset;\n  }\n\n  css(property: string): string {\n    if (Referentiel.jquery) {\n      return Referentiel.jquery(this.reference).css(property);\n    }\n    if (\n      this.reference instanceof Element ||\n      this.reference instanceof SVGElement\n    ) {\n      return window.getComputedStyle(this.reference).getPropertyValue(property);\n    }\n    return \"\";\n  }\n\n  static mult(...args: Matrix[]): Matrix {\n    const [a, b, ...rest] = args;\n    if (!a) throw new Error(\"Matrix is null\");\n    if (!b) return a;\n    return Referentiel.mult(Referentiel.multiply(a, b), ...rest);\n  }\n\n  static identity(): Matrix {\n    return [\n      [1, 0, 0],\n      [0, 1, 0],\n      [0, 0, 1],\n    ];\n  }\n\n  static det(m: Matrix): number {\n    return (\n      m[0][0] * (m[1][1] * m[2][2] - m[2][1] * m[1][2]) -\n      m[0][1] * (m[1][0] * m[2][2] - m[1][2] * m[2][0]) +\n      m[0][2] * (m[1][0] * m[2][1] - m[1][1] * m[2][0])\n    );\n  }\n\n  static inv(m: Matrix): Matrix {\n    const invdet = 1.0 / Referentiel.det(m);\n    return [\n      [\n        (m[1][1] * m[2][2] - m[2][1] * m[1][2]) * invdet,\n        (m[0][2] * m[2][1] - m[0][1] * m[2][2]) * invdet,\n        (m[0][1] * m[1][2] - m[0][2] * m[1][1]) * invdet,\n      ],\n      [\n        (m[1][2] * m[2][0] - m[1][0] * m[2][2]) * invdet,\n        (m[0][0] * m[2][2] - m[0][2] * m[2][0]) * invdet,\n        (m[1][0] * m[0][2] - m[0][0] * m[1][2]) * invdet,\n      ],\n      [\n        (m[1][0] * m[2][1] - m[2][0] * m[1][1]) * invdet,\n        (m[2][0] * m[0][1] - m[0][0] * m[2][1]) * invdet,\n        (m[0][0] * m[1][1] - m[1][0] * m[0][1]) * invdet,\n      ],\n    ];\n  }\n\n  static multiply(a: Matrix, b: Matrix): Matrix {\n    const index = [0, 1, 2] as const;\n    const res: Matrix = [\n      [0.0, 0.0, 0.0],\n      [0.0, 0.0, 0.0],\n      [0.0, 0.0, 0.0],\n    ];\n    index.forEach((i) => {\n      index.forEach((j) => {\n        index.forEach((k) => (res[i][j] += a[i][k] * b[k][j]));\n      });\n    });\n    return res;\n  }\n}\n\nexport { Referentiel };\n"]}